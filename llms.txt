# R package ‘pvEBayes’

‘pvEBayes’ is an R package that implements a suite of nonparametric
empirical Bayes methods for pharmacovigilance including Gamma-Poisson
Shrinker (GPS), K-gamma, general-gamma, Koenker-Mizera (KM), and Efron
models. It provides tools for fitting these models to spontaneous
reporting system (SRS) frequency tables, extracting summaries,
performing hyperparameter tuning, and generating graphical summaries
(eye plots and heatmaps) for signal detection and estimation.

For methodological details, see:

Tan Y, Markatou M and Chakraborty S. Flexible Empirical Bayesian
Approaches to Pharmacovigilance for Simultaneous Signal Detection and
Signal Strength Estimation in Spontaneous Reporting Systems Data.
*Statistics in Medicine.* 2025; 44: 18-19,
<https://doi.org/10.1002/sim.70195>.

## Installation

The stable version of `pvEBayes` can be installed from CRAN:

    install.packages("pvEBayes")

The development version is available from GitHub:

    # if (!requireNamespace("devtools")) install.packages("devtools")
    devtools::install_github("YihaoTancn/pvEBayes")

## Quick Example

Here is a minimal example analyzing the built-in FDA statin44 dataset
with general-gamma model:

    library(pvEBayes)

    # Load the statin44 contingency table of 44 AEs for 6 statins
    data("statin2025_44")

    # Fit a general-gamma model with a specified alpha
    fit <- pvEBayes(
      contin_table      = statin2025_44,
      model             = "general-gamma",
      alpha             = 0.3,
      n_posterior_draws = 1000
    )

    # Print out a concise description of the fitted model
    fit

    # Obtain a logical matrix for the detected signal
    summary(fit, return = "detected signal")

    # Visualize posterior distributions for top AE-drug pairs
    plot(fit, type = "eyeplot")

For a more detailed illustration, please see ‘Vignette’.

## License

‘pvEBayes’ is released under the GPL-3 license. See ‘LICENSE.md’ for
details.

# Package index

## All functions

- [`AIC(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/AIC.pvEBayes.md)
  : Obtain Akaike Information Criterion (AIC) for a pvEBayes object
- [`BIC(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/BIC.pvEBayes.md)
  : Obtain Bayesian Information Criterion (BIC) for a pvEBayes object
- [`estimate_null_expected_count()`](https://yihaotancn.github.io/pvEBayes/reference/estimate_null_expected_count.md)
  : Estimate expected null baseline count based on reference row and
  column
- [`extract_all_fitted_models()`](https://yihaotancn.github.io/pvEBayes/reference/extract_all_fitted_models.md)
  : Extract all fitted models from a tuned pvEBayes Object
- [`eyeplot_pvEBayes()`](https://yihaotancn.github.io/pvEBayes/reference/eyeplot_pvEBayes.md)
  : Generate an eyeplot showing the distribution of posterior draws for
  selected drugs and adverse events
- [`gbca2025`](https://yihaotancn.github.io/pvEBayes/reference/gbca2025.md)
  : FDA GBCA dataset with 1328 adverse events
- [`gbca2025_69`](https://yihaotancn.github.io/pvEBayes/reference/gbca2025_69.md)
  : FDA GBCA dataset with 69 adverse events
- [`generate_contin_table()`](https://yihaotancn.github.io/pvEBayes/reference/generate_contin_table.md)
  : Generate random contingency tables based on a reference table
  embedded signals,and possibly with zero inflation
- [`heatmap_pvEBayes()`](https://yihaotancn.github.io/pvEBayes/reference/heatmap_pvEBayes.md)
  : Generate a heatmap plot visualizing posterior probabilities for
  selected drugs and adverse events
- [`logLik(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/logLik.pvEBayes.md)
  : Extract log marginal likelihood for a pvEBayes object
- [`plot(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/plot.pvEBayes.md)
  : Plotting method for a pvEBayes object
- [`posterior_draws()`](https://yihaotancn.github.io/pvEBayes/reference/posterior_draws.md)
  : Generate posterior draws for each AE-drug combination
- [`print(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/print.pvEBayes.md)
  : Print method for a pvEBayes object
- [`pvEBayes()`](https://yihaotancn.github.io/pvEBayes/reference/pvEBayes.md)
  : Fit a general-gamma, GPS, K-gamma, KM or efron model for a
  contingency table.
- [`pvEBayes_tune()`](https://yihaotancn.github.io/pvEBayes/reference/pvEBayes_tune.md)
  : Select hyperparameter and obtain the optimal general-gamma or efron
  model based on AIC and BIC
- [`statin2025`](https://yihaotancn.github.io/pvEBayes/reference/statin2025.md)
  : FDA statin dataset with 5119 adverse events
- [`statin2025_44`](https://yihaotancn.github.io/pvEBayes/reference/statin2025_44.md)
  : FDA statin dataset with 44 adverse events
- [`statin42`](https://yihaotancn.github.io/pvEBayes/reference/statin42.md)
  : FDA statin dataset with 42 adverse events
- [`summary(`*`<pvEBayes>`*`)`](https://yihaotancn.github.io/pvEBayes/reference/summary.pvEBayes.md)
  : Summary method for a pvEBayes object

# Articles

### All vignettes

- [Analyzing SRS frequency table with
  pvEBayes](https://yihaotancn.github.io/pvEBayes/articles/pvEBayes-introduction.md):
