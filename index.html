<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Empirical Bayes Methods for Pharmacovigilance • pvEBayes</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Empirical Bayes Methods for Pharmacovigilance">
<meta name="description" content="A suite of empirical Bayes methods to use in pharmacovigilance. Contains various model fitting and post-processing functions. For more details see Tan et al. (2025) &lt;doi:10.48550/arXiv.2502.09816&gt;, &lt;doi:10.48550/arXiv.2512.01057&gt;; Koenker and Mizera (2014) &lt;doi:10.1080/01621459.2013.869224&gt;; Efron (2016) &lt;doi:10.1093/biomet/asv068&gt;.">
<meta property="og:description" content="A suite of empirical Bayes methods to use in pharmacovigilance. Contains various model fitting and post-processing functions. For more details see Tan et al. (2025) &lt;doi:10.48550/arXiv.2502.09816&gt;, &lt;doi:10.48550/arXiv.2512.01057&gt;; Koenker and Mizera (2014) &lt;doi:10.1080/01621459.2013.869224&gt;; Efron (2016) &lt;doi:10.1093/biomet/asv068&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pvEBayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/pvEBayes-introduction.html">Introduction to pvEBayes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/YihaoTancn/pvEBayes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="r-package-pvebayes">R package <code>pvEBayes</code>
<a class="anchor" aria-label="anchor" href="#r-package-pvebayes"></a>
</h1></div>
<!-- badges: start -->

<p><code>pvEBayes</code> is an R package that implements a suite of nonparametric empirical Bayes methods for pharmacovigilance, including Gamma-Poisson Shrinker (GPS), K-gamma, general-gamma, Koenker-Mizera (KM), and Efron models. It provides tools for fitting these models to the spontaneous reporting system (SRS) frequency tables, extracting summaries, performing hyperparameter tuning, and generating graphical summaries (eye plots and heatmaps) for signal detection and estimation.</p>
<p><strong>Spontaneous Reporting System (SRS) Table</strong>: An drug safety SRS dataset catalogs AE reports on <em>I</em> AE rows across <em>J</em> drug columns. Let <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">{N_{ij}}</annotation></semantics></math> denote the number of reported cases for the <em>i</em>-th AE and the <em>j</em>-th drug, where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">{i = 1,..., I}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>J</mi></mrow><annotation encoding="application/x-tex">{j = 1,..., J}</annotation></semantics></math>.</p>
<p><strong>Empirical Bayes modeling for disproportionality analysis</strong>: We assume that for each AE-drug pair, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_{ij} \sim \text{Poisson}(\lambda_{ij} E_{ij})</annotation></semantics></math>, where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">{E_{ij}}</annotation></semantics></math> is the expected baseline value, measuring the expected count of the AE-drug pair when there is no association between<em>i</em>-th AE and <em>j</em>-th drug. The parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\lambda_{ij} \geq 0}</annotation></semantics></math> represents the relative reporting ratio, the signal strength, for the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">{(i, j)}</annotation></semantics></math>-th pair, measuring the ratio of the actual expected count arising due to dependence on the null baseline expected count. Current disproportionality analysis mainly focuses on <em>signal detection</em> which seeks to determine whether the observation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">N_{ij}</annotation></semantics></math> is substantially greater than the corresponding null baseline <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">E_{ij}</annotation></semantics></math>. Under the Poisson model, that is to say, its signal strength <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{ij}</annotation></semantics></math> is significantly greater than 1.</p>
<p>In addition to <em>signal detection</em>, Tan et al. (<em>Stat. in Med.</em>, 2025) broaden the role of disproportionality to <em>signal estimation</em>. The use of the flexible non-parametric empirical Bayes models enables more nuanced empirical Bayes posterior inference (parameter estimation and uncertainty quantification) on signal strength parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>λ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{ \lambda_{ij} \}</annotation></semantics></math>. This allows researchers to distinguish AE-drug pairs that would appear similar under a binary signal detection framework. For example, the AE-drug pairs with signal strengths of 1.5 and 4.0 could both be significantly greater than 1 and detected as a signal. Such differences in signal strength may have distinct implications in medical and clinical contexts.</p>
<p>The methods included in <code>pvEBayes</code> differ by their assumptions on the prior distribution. Implemented methods include the Gamma-Poisson Shrinker (GPS), Koenker-Mizera (KM) method, Efron’s nonparametric empirical Bayes approach, the K-gamma model, and the general-gamma model. The selection of the prior distribution is critical in Bayesian analysis. The GPS model uses a gamma mixture prior by assuming the signal/non-signal structure in SRS data. However, in real-world setting, signal strengths <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">{(\lambda_{ij})}</annotation></semantics></math> are often heterogeneous and thus follows a multi-modal distribution, making it difficult to assume a parametric prior. Non-parametric empirical Bayes models (KM, Efron, K-gamma and general-gamma) address this challenge by utilizing a flexible prior with a general mixture form and estimating the prior distribution in a data-driven way.</p>
<p><strong>Implementations</strong>: The KM method has an existing implementation in the <code>REBayes</code> package, but it relies on Mosek, a commercial convex optimization solver, which may limit accessibility due to licensing issues. The <code>pvEBayes</code> package provides an alternative fully open-source implementation of the KM method using <code>CVXR</code>. Efron’s method also has a general nonparametric empirical Bayes implementation in the <code>deconvolveR</code> package; however, that implementation does not support an exposure or offset parameter in the Poisson model, which corresponds to the expected null value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">{E_{ij}}</annotation></semantics></math>. In <code>pvEBayes</code>, the implementation of Efron’s method is adapted and modified from <code>deconvolveR</code> to support <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">{E_{ij}}</annotation></semantics></math> in the Poisson model.</p>
<p>In addition, this package implements the novel bi-level Expectation Conditional Maximization (ECM) algorithm proposed by Tan et al. (2025) for efficient parameter estimation in gamma mixture prior based models mentioned above.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The stable version of <code>pvEBayes</code> can be installed from CRAN:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pvEBayes"</span><span class="op">)</span></span></code></pre>
<p>The development version is available from GitHub:</p>
<pre><code><span><span class="co"># if (!requireNamespace("devtools")) install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"YihaoTancn/pvEBayes"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="quick-example">Quick Example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<p>Here is a minimal example analyzing the built-in FDA statin44 dataset with general-gamma model:</p>
<pre><code><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/YihaoTancn/pvEBayes" class="external-link">pvEBayes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the statin44 contingency table of 44 AEs for 6 statins</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"statin2025_44"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a general-gamma model with a specified alpha</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pvEBayes.html">pvEBayes</a></span><span class="op">(</span></span>
<span>  contin_table      <span class="op">=</span> <span class="va">statin2025_44</span>,</span>
<span>  model             <span class="op">=</span> <span class="st">"general-gamma"</span>,</span>
<span>  alpha             <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  n_posterior_draws <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print out a concise description of the fitted model</span></span>
<span><span class="va">fit</span></span>
<span></span>
<span><span class="co"># Obtain a logical matrix for the detected signal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, return <span class="op">=</span> <span class="st">"detected signal"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize posterior distributions for top AE-drug pairs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"eyeplot"</span><span class="op">)</span></span></code></pre>
<p>For a more detailed illustration, please see ‘Vignette’.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p><code>pvEBayes</code> is released under the GPL-3 license. See ‘LICENSE.md’ for details.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>pvEBayes</code> project is released with a <a href="https://yihaotancn.github.io/pvEBayes/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Tan Y, Markatou M and Chakraborty S. Flexible Empirical Bayesian Approaches to Pharmacovigilance for Simultaneous Signal Detection and Signal Strength Estimation in Spontaneous Reporting Systems Data. <em>Statistics in Medicine</em>. 2025; 44: 18-19, <a href="https://doi.org/10.1002/sim.70195" class="external-link uri">https://doi.org/10.1002/sim.70195</a>.</p>
<p>Tan Y, Markatou M and Chakraborty S. pvEBayes: An R Package for Empirical Bayes Methods in Pharmacovigilance. <em>arXiv</em>:2512.01057 (stat.AP). <a href="https://doi.org/10.48550/arXiv.2512.01057" class="external-link uri">https://doi.org/10.48550/arXiv.2512.01057</a></p>
<p>Koenker R, Mizera I. Convex Optimization, Shape Constraints, Compound Decisions, and Empirical Bayes Rules. <em>Journal of the American Statistical Association</em> 2014; 109(506): 674–685, <a href="https://doi.org/10.1080/01621459.2013.869224" class="external-link uri">https://doi.org/10.1080/01621459.2013.869224</a></p>
<p>Efron B. Empirical Bayes Deconvolution Estimates. <em>Biometrika</em> 2016; 103(1); 1-20, <a href="https://doi.org/10.1093/biomet/asv068" class="external-link uri">https://doi.org/10.1093/biomet/asv068</a></p>
<p>DuMouchel W. Bayesian data mining in large frequency tables, with an application to the FDA spontaneous reporting system. <em>The American Statistician</em>. 1999; 1;53(3):177-90.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=pvEBayes" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/YihaoTancn/pvEBayes/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/YihaoTancn/pvEBayes/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pvEBayes</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yihao Tan <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0002-9196-8166" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Marianthi Markatou <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1453-8229" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Saptarshi Chakraborty <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-3121-9174" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Raktim Mukhopadhyay <br><small class="roles"> Author </small> <a href="https://orcid.org/0009-0007-8972-6682" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=pvEBayes" class="external-link"><img src="https://www.r-pkg.org/badges/version/pvEBayes" alt="CRAN status"></a></li>
<li><a href="https://github.com/YihaoTancn/pvEBayes/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/YihaoTancn/pvEBayes/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/YihaoTancn/pvEBayes" class="external-link"><img src="https://codecov.io/gh/YihaoTancn/pvEBayes/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://www.codefactor.io/repository/github/yihaotancn/pvebayes" class="external-link"><img src="https://www.codefactor.io/repository/github/yihaotancn/pvebayes/badge" alt="CodeFactor"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yihao Tan, Marianthi Markatou, Saptarshi Chakraborty, Raktim Mukhopadhyay.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
