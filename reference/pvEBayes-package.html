<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>A suite of empirical Bayes methods to use in pharmacovigilance. — pvEBayes-package • pvEBayes</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A suite of empirical Bayes methods to use in pharmacovigilance. — pvEBayes-package"><meta name="description" content="pvEBayes provides a collection of parametric and non-parametric
empirical Bayes methods implementation for pharmacovigilance (including
signal detection and signal estimation) on spontaneous reporting systems
(SRS) data.
An SRS dataset catalogs AE reports on I AE rows across J drug columns.
Let \(N_{ij}\) denote the number of reported cases for the
i-th AE and the j-th drug, where \(i = 1,..., I\) and
\(j = 1,..., J\). We assume that for each AE-drug pair,
\(N_{ij} \sim \text{Poisson}(\lambda_{ij} E_{ij})\), where \(E_{ij}\) is
expected baseline value measuring the expected count of the AE-drug pair
when there is no association between i-th AE and j-th drug. The parameter
\(\lambda_{ij} \geq 0\) represents the relative reporting ratio, the signal
strength, for the \((i, j)\)-th pair measuring the ratio of the actual
expected count arising due to dependence to the null baseline expected count.
Current disproportionality analysis mainly focuses on signal detection
which seeks to determine whether the observation \(N_{ij}\) is substantially
greater than the corresponding null baseline \(E_{ij}\). Under the Poisson
model, that is to say, its signal strength \(\lambda_{ij}\) is
significantly greater than 1.
In addition to signal detection, Tan et al. (Stat. in Med., 2025) broaden
the role of disproportionality to signal estimation. The use of the flexible
non-parametric empirical Bayes models enables more nuanced empirical Bayes
posterior inference (parameter estimation and uncertainty quantification) on
signal strength parameter \(\{ \lambda_{ij} \}\). This allows researchers to
distinguish AE-drug pairs that would appear similar under a binary signal
detection framework. For example, the AE-drug pairs with signal strengths of
1.5 and 4.0 could both be significantly greater than 1 and detected as a
signal. Such differences in signal strength may have distinct implications in
medical and clinical contexts.
The methods included in pvEBayes differ by their assumptions on the
prior distribution. Implemented methods include the Gamma-Poisson Shrinker
(GPS), Koenker-Mizera (KM) method, Efron’s nonparametric empirical Bayes
approach, the K-gamma model, and the general-gamma model.
The GPS model uses two gamma mixture prior by assuming the signal/non-signal
structure in SRS data. However, in real-world setting, signal
strengths \((\lambda_{ij})\) are often heterogeneous and thus follows a
multi-modal distribution, making it difficult to assume a parametric prior.
Non-parametric empirical Bayes models (KM, Efron, K-gamma and general-gamma)
address this challenge by utilizing a flexible prior with general mixture
form and estimating the prior distribution in a data-driven way.
pvEBayes offers the first implemention of the bi-level Expectation
Conditional Maximization (ECM) algorithm proposed by Tan et al. (2025) for
efficient parameter estimation in gamma mixture prior based models: GPS
K-gamma and general-gamma.
The KM method has an existing implementation in the REBayes package,
but it relies on Mosek, a commercial convex optimization solver, which may
limit accessibility due to licensing issue. pvEBayes provides a
alternative fully open-source implementation of the KM method using
CVXR.
Efron’s method also has a general nonparametric empirical Bayes
implementation in the deconvolveR package; however, that
implementation does not support an exposure or offset parameter in the
Poisson model, which corresponds to the expected null value \(E_{ij}\).
In pvEBayes, the implementation of the Efron's method is adapted and
modified from deconvolveR to support \(E_{ij}\) in Poisson model.
For an introduction to pvEBayes, see the vignette."><meta property="og:description" content="pvEBayes provides a collection of parametric and non-parametric
empirical Bayes methods implementation for pharmacovigilance (including
signal detection and signal estimation) on spontaneous reporting systems
(SRS) data.
An SRS dataset catalogs AE reports on I AE rows across J drug columns.
Let \(N_{ij}\) denote the number of reported cases for the
i-th AE and the j-th drug, where \(i = 1,..., I\) and
\(j = 1,..., J\). We assume that for each AE-drug pair,
\(N_{ij} \sim \text{Poisson}(\lambda_{ij} E_{ij})\), where \(E_{ij}\) is
expected baseline value measuring the expected count of the AE-drug pair
when there is no association between i-th AE and j-th drug. The parameter
\(\lambda_{ij} \geq 0\) represents the relative reporting ratio, the signal
strength, for the \((i, j)\)-th pair measuring the ratio of the actual
expected count arising due to dependence to the null baseline expected count.
Current disproportionality analysis mainly focuses on signal detection
which seeks to determine whether the observation \(N_{ij}\) is substantially
greater than the corresponding null baseline \(E_{ij}\). Under the Poisson
model, that is to say, its signal strength \(\lambda_{ij}\) is
significantly greater than 1.
In addition to signal detection, Tan et al. (Stat. in Med., 2025) broaden
the role of disproportionality to signal estimation. The use of the flexible
non-parametric empirical Bayes models enables more nuanced empirical Bayes
posterior inference (parameter estimation and uncertainty quantification) on
signal strength parameter \(\{ \lambda_{ij} \}\). This allows researchers to
distinguish AE-drug pairs that would appear similar under a binary signal
detection framework. For example, the AE-drug pairs with signal strengths of
1.5 and 4.0 could both be significantly greater than 1 and detected as a
signal. Such differences in signal strength may have distinct implications in
medical and clinical contexts.
The methods included in pvEBayes differ by their assumptions on the
prior distribution. Implemented methods include the Gamma-Poisson Shrinker
(GPS), Koenker-Mizera (KM) method, Efron’s nonparametric empirical Bayes
approach, the K-gamma model, and the general-gamma model.
The GPS model uses two gamma mixture prior by assuming the signal/non-signal
structure in SRS data. However, in real-world setting, signal
strengths \((\lambda_{ij})\) are often heterogeneous and thus follows a
multi-modal distribution, making it difficult to assume a parametric prior.
Non-parametric empirical Bayes models (KM, Efron, K-gamma and general-gamma)
address this challenge by utilizing a flexible prior with general mixture
form and estimating the prior distribution in a data-driven way.
pvEBayes offers the first implemention of the bi-level Expectation
Conditional Maximization (ECM) algorithm proposed by Tan et al. (2025) for
efficient parameter estimation in gamma mixture prior based models: GPS
K-gamma and general-gamma.
The KM method has an existing implementation in the REBayes package,
but it relies on Mosek, a commercial convex optimization solver, which may
limit accessibility due to licensing issue. pvEBayes provides a
alternative fully open-source implementation of the KM method using
CVXR.
Efron’s method also has a general nonparametric empirical Bayes
implementation in the deconvolveR package; however, that
implementation does not support an exposure or offset parameter in the
Poisson model, which corresponds to the expected null value \(E_{ij}\).
In pvEBayes, the implementation of the Efron's method is adapted and
modified from deconvolveR to support \(E_{ij}\) in Poisson model.
For an introduction to pvEBayes, see the vignette."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pvEBayes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pvEBayes-introduction.html">Introduction to pvEBayes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/YihaoTancn/pvEBayes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A suite of empirical Bayes methods to use in pharmacovigilance.</h1>
      <small class="dont-index">Source: <a href="https://github.com/YihaoTancn/pvEBayes/blob/main/R/pvEBayes-package.R" class="external-link"><code>R/pvEBayes-package.R</code></a></small>
      <div class="d-none name"><code>pvEBayes-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>pvEBayes</code> provides a collection of parametric and non-parametric
empirical Bayes methods implementation for pharmacovigilance (including
signal detection and signal estimation) on spontaneous reporting systems
(SRS) data.</p>
<p>An SRS dataset catalogs AE reports on <em>I</em> AE rows across <em>J</em> drug columns.
Let \(N_{ij}\) denote the number of reported cases for the
<em>i</em>-th AE and the <em>j</em>-th drug, where \(i = 1,..., I\) and
\(j = 1,..., J\). We assume that for each AE-drug pair,
\(N_{ij} \sim \text{Poisson}(\lambda_{ij} E_{ij})\), where \(E_{ij}\) is
expected baseline value measuring the expected count of the AE-drug pair
when there is no association between <em>i</em>-th AE and <em>j</em>-th drug. The parameter
\(\lambda_{ij} \geq 0\) represents the relative reporting ratio, the signal
strength, for the \((i, j)\)-th pair measuring the ratio of the actual
expected count arising due to dependence to the null baseline expected count.
Current disproportionality analysis mainly focuses on <em>signal detection</em>
which seeks to determine whether the observation \(N_{ij}\) is substantially
greater than the corresponding null baseline \(E_{ij}\). Under the Poisson
model, that is to say, its signal strength \(\lambda_{ij}\) is
significantly greater than 1.</p>
<p>In addition to <em>signal detection</em>, Tan et al. (<em>Stat. in Med.</em>, 2025) broaden
the role of disproportionality to <em>signal estimation</em>. The use of the flexible
non-parametric empirical Bayes models enables more nuanced empirical Bayes
posterior inference (parameter estimation and uncertainty quantification) on
signal strength parameter \(\{ \lambda_{ij} \}\). This allows researchers to
distinguish AE-drug pairs that would appear similar under a binary signal
detection framework. For example, the AE-drug pairs with signal strengths of
1.5 and 4.0 could both be significantly greater than 1 and detected as a
signal. Such differences in signal strength may have distinct implications in
medical and clinical contexts.</p>
<p>The methods included in <code>pvEBayes</code> differ by their assumptions on the
prior distribution. Implemented methods include the Gamma-Poisson Shrinker
(GPS), Koenker-Mizera (KM) method, Efron’s nonparametric empirical Bayes
approach, the K-gamma model, and the general-gamma model.</p>
<p>The GPS model uses two gamma mixture prior by assuming the signal/non-signal
structure in SRS data. However, in real-world setting, signal
strengths \((\lambda_{ij})\) are often heterogeneous and thus follows a
multi-modal distribution, making it difficult to assume a parametric prior.
Non-parametric empirical Bayes models (KM, Efron, K-gamma and general-gamma)
address this challenge by utilizing a flexible prior with general mixture
form and estimating the prior distribution in a data-driven way.</p>
<p><code>pvEBayes</code> offers the first implemention of the bi-level Expectation
Conditional Maximization (ECM) algorithm proposed by Tan et al. (2025) for
efficient parameter estimation in gamma mixture prior based models: GPS
K-gamma and general-gamma.</p>
<p>The KM method has an existing implementation in the <code>REBayes</code> package,
but it relies on Mosek, a commercial convex optimization solver, which may
limit accessibility due to licensing issue. <code>pvEBayes</code> provides a
alternative fully open-source implementation of the KM method using
<code>CVXR</code>.</p>
<p>Efron’s method also has a general nonparametric empirical Bayes
implementation in the <code>deconvolveR</code> package; however, that
implementation does not support an exposure or offset parameter in the
Poisson model, which corresponds to the expected null value \(E_{ij}\).
In <code>pvEBayes</code>, the implementation of the Efron's method is adapted and
modified from <code>deconvolveR</code> to support \(E_{ij}\) in Poisson model.</p>
<p>For an introduction to <code>pvEBayes</code>, see the vignette.</p>
    </div>


    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tan Y, Markatou M and Chakraborty S. Flexible Empirical Bayesian Approaches
to Pharmacovigilance for Simultaneous Signal Detection and Signal Strength
Estimation in Spontaneous Reporting Systems Data.
<em>Statistics in Medicine.</em> 2025; 44: 18-19,
https://doi.org/10.1002/sim.70195.</p>
<p>Tan Y, Markatou M and Chakraborty S. pvEBayes: An R Package for Empirical
Bayes Methods in Pharmacovigilance.
<em>arXiv</em>:2512.01057 (stat.AP). https://doi.org/10.48550/arXiv.2512.01057</p>
<p>Koenker R, Mizera I. Convex Optimization, Shape Constraints, Compound
Decisions, and Empirical Bayes Rules. <em>Journal of the American
Statistical Association</em> 2014; 109(506): 674–685,
https://doi.org/10.1080/01621459.2013.869224</p>
<p>Efron B. Empirical Bayes Deconvolution Estimates. <em>Biometrika</em> 2016;
103(1); 1-20, https://doi.org/10.1093/biomet/asv068</p>
<p>DuMouchel W. Bayesian data mining in large frequency tables, with an
application to the FDA spontaneous reporting system.
<em>The American Statistician.</em> 1999; 1;53(3):177-90.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/YihaoTancn/pvEBayes" class="external-link">https://github.com/YihaoTancn/pvEBayes</a></p></li>
<li><p><a href="https://yihaotancn.github.io/pvEBayes/">https://yihaotancn.github.io/pvEBayes/</a></p></li>
<li><p>Report bugs at <a href="https://github.com/YihaoTancn/pvEBayes/issues" class="external-link">https://github.com/YihaoTancn/pvEBayes/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yihao Tan, Marianthi Markatou, Saptarshi Chakraborty and Raktim Mukhopadhyay.</p>
<p>Maintainer: Yihao Tan <a href="mailto:yihaotan@buffalo.edu">yihaotan@buffalo.edu</a></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yihao Tan, Marianthi Markatou, Saptarshi Chakraborty, Raktim Mukhopadhyay.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

